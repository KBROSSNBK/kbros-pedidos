
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üî• KBROS üî•</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0; padding: 0; background: #fff; color: #000;
    }
    header {
      background: #000; color: #fff; padding: 1em;
      text-align: center; font-size: 1.6em; letter-spacing: 1px;
    }
    .top-buttons {
      display: flex; justify-content: center; align-items: center;
      gap: 0.6em; flex-wrap: wrap; padding: 1em;
    }
    .top-buttons button {
      font-size: 1.1em; padding: 0.6em 1em;
      border-radius: 10px; background: #000; color: #fff;
      border: none; cursor: pointer;
    }
    .categoria-btn {
      padding: 1em; font-size: 1.2em; font-weight: bold;
      background: #f5f5f5; border-top: 2px solid #000;
      cursor: pointer; transition: background 0.3s ease;
    }
    .productos {
      display: none; flex-wrap: wrap; justify-content: center;
      padding: 0.5em 1em 1em 1em; animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from {opacity: 0;} to {opacity: 1;}
    }
    .producto {
      background: #f9f9f9; border: 1px solid #ccc;
      border-radius: 10px; margin: 0.4em; padding: 1em;
      width: 46%; box-sizing: border-box; cursor: pointer;
      font-size: 0.95em; text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: transform 0.2s, background 0.2s;
    }
    .producto:active { transform: scale(0.95); background: #ddd; }
    .carrito-fijo {
      position: fixed; bottom: 0; width: 100%;
      background: #fff; border-top: 2px solid #000;
      display: flex; justify-content: space-between;
      padding: 1em; box-shadow: 0 -2px 5px rgba(0,0,0,0.2);
      z-index: 10;
    }
    .carrito-fijo button {
      flex: 1; margin: 0 0.5em; padding: 1em;
      font-size: 1em; border: none; border-radius: 8px;
      cursor: pointer; transition: transform 0.2s;
    }
    .carrito-fijo button:active { transform: scale(0.97); }
    .limpiar { background: #ff5c5c; color: white; }
    .pedir {
      background: #4caf50; color: white; animation: none;
    }
    .pedir.animar {
      animation: bounce 0.7s ease infinite;
    }
    .total {
      font-weight: bold; align-self: center; margin: 0 0.5em;
    }
    .contador {
      font-size: 1.1em; font-weight: bold; display: flex; align-items: center;
      gap: 5px; background: #000; color: #fff; padding: 0.5em 1em;
      border-radius: 10px;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }
  </style>
</head>
<body>
  <header>üî• KBROS üî•</header>
  <div class="top-buttons">
    <button onclick="toggleMenu()">MEN√ö üòã</button>
    <div class="contador">üõí <span id="contadorCarrito">0</span></div>
    <div class="contador" onclick="sumarLike()">‚ù§ <span id="contadorLikes">0</span></div>
    <div class="contador">üëÅ <span id="contadorUsuarios">0</span></div>
  </div>
  <div id="menu"></div>

  <div id="carrito-detalle" style="display:none; padding:1em; background:#f8f8f8; border-top:2px solid #000;">
  <h3>üõí Detalle del pedido</h3>
  <ul id="detalleItems" style="list-style:none; padding-left:0;"></ul>
</div>


<div class="carrito-fijo">
    <button class="limpiar" onclick="limpiarCarrito()">LIMPIAR</button>
    <div class="total" id="total">üí≤0</div>
    <button class="pedir" id="btnPedir" onclick="enviarPedido()">PEDIR</button>
  </div>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDR-LnHsJ54kj-5vRzB3NoK-EB-ELD9xQs",
      authDomain: "kbros-web.firebaseapp.com",
      databaseURL: "https://kbros-web-default-rtdb.firebaseio.com",
      projectId: "kbros-web",
      storageBucket: "kbros-web.firebasestorage.app",
      messagingSenderId: "281753184526",
      appId: "1:281753184526:web:c6e824fefd7b261a428f5f",
      measurementId: "G-YRHHRCGKK0"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let carrito = [];
    let menuVisible = false;

    function toggleMenu() {
      const menu = document.getElementById("menu");
      menu.style.display = menuVisible ? "none" : "block";
      menuVisible = !menuVisible;
    }

    function agregar(nombre, precio) {
      const item = carrito.find(p => p.nombre === nombre);
      if (item) item.cantidad++;
      else carrito.push({ nombre, precio, cantidad: 1 });
      renderTotal();
    }

    function renderTotal() {
      const total = carrito.reduce((sum, p) => sum + p.precio * p.cantidad, 0);
      document.getElementById("total").textContent = "üí≤" + total;
      document.getElementById("btnPedir").classList.toggle("animar", total > 0);
      document.getElementById("contadorCarrito").textContent = carrito.reduce((a, b) => a + b.cantidad, 0);
      mostrarDetalleCarrito();
    }
    
function mostrarDetalleCarrito() {
  const lista = document.getElementById("detalleItems");
  const panel = document.getElementById("carrito-detalle");
  lista.innerHTML = '';
  carrito.forEach(p => {
    lista.innerHTML += `<li>${p.nombre} x${p.cantidad} = üí≤${p.precio * p.cantidad}</li>`;
  });
  panel.style.display = carrito.length > 0 ? "block" : "none";
}

    function limpiarCarrito() {
      carrito = [];
      renderTotal();
    }

    function enviarPedido() {
      const nombre = prompt("Ingresa tu nombre:");
      if (!nombre || carrito.length === 0) return;
      const total = carrito.reduce((sum, p) => sum + p.precio * p.cantidad, 0);
      const mensaje = `Hola! Soy ${nombre}. Quiero pedir:\n` +
        carrito.map(p => `- ${p.nombre} x${p.cantidad} üí≤${p.precio * p.cantidad}`).join("\n") +
        `\nTOTAL: üí≤${total}`;
      window.open(`https://wa.me/56956446048?text=${encodeURIComponent(mensaje)}`, "_blank");
    }

    function sumarLike() {
      db.ref("likes").transaction(current => (current || 0) + 1);
    }

    function renderMenu() {
      const categorias = {
      "COMPLETOS üå≠": [
        ["HOT DOG - CHICO", 1200], ["HOT DOG - GRANDE", 1800],
        ["ITALIANO - CHICO", 2000], ["ITALIANO - GRANDE", 3000],
        ["COMPLETO - CHICO", 1800], ["COMPLETO - GRANDE", 2400],
        ["TOCOMPLE - CHICO", 2500], ["TOCOMPLE - GRANDE", 3500],
        ["DINAMICO - CHICO", 2500], ["DINAMICO - GRANDE", 3500],
        ["CHAMO - CHICO", 2000], ["CHAMO - GRANDE", 3000],
        ["AS - CHICO", 2200], ["AS - GRANDE", 2800],
        ["AS - ITALIANO - CHICO", 3000], ["AS - ITALIANO - GRANDE", 4000],
        ["AS - COMPLETO - CHICO", 2800], ["AS - COMPLETO - GRANDE", 3400],
        ["AS - TOCOMPLE - CHICO", 3500], ["AS - TOCOMPLE - GRANDE", 4500],
        ["AS - DINAMICO - CHICO", 3500], ["AS - DINAMICO - GRANDE", 4500],
        ["AS - QUESO - CHICO", 3000], ["AS - QUESO - GRANDE", 4000]
      ],
      "HAMBURGUESAS üçî": [["HAMBURGUESA CLASICA",4500],["HAMBURGUESA ITALIANA",4500],["HAMBURGUESA AMERICANA",4500],["CHEDDAR BACON",5500],["CON PAPAS",1000],["PAPAS + SALSA CHEDDAR",1500],["HAMBURGUESA + CHEDDAR",1000]],
      "MECHADAS üçî": [["MECHA-LUCO",5000],["MECHADA ITALIANO",5000],["MECHADA CHACARERO",5000],["MECHAITO",5500],["CON PAPAS",1000],["PAPAS + SALSA CHEDDAR",1500]],
      "CHURRASCOS üçî": [["CHURRAS-LUCO",4500],["CHURRASCO ITALIANO",4500],["CHURRASCO CHACARERO",4500],["CHURRASQUITO",5000],["CON PAPAS",1000],["PAPAS + SALSA CHEDDAR",1500]],
      "FAJITAS üåØ": [["FAJITA PIOLA",4500],["FAJITA KBROS",5000],["FAJITA A TU PINTA",5000]],
      "PAPAS FRITAS üçü": [["PAPAS ALTOKE CHICA",2000],["PAPAS ALTOKE GRANDE",3500],["SALCHIPAPAS",4000],["PAPAS PIOLA",4000],["PAPAS PULENTAS",4500],["PAPAS GRINGAS",4800],["PAPAS CHIDAS",4500]],
      "EMPANADAS ü•ü": [["EMPANADAS DE QUESO X5",2000]],
      "BEBESTIBLES ü•§": [["BEBIDA LATA",1200],["JUGO",1500],["AGUA",1000]],
      "BEBESTIBLES ‚òï": [["T√â",1000],["CAF√â",1000]]
    };

      const cont = document.getElementById("menu");
      cont.innerHTML = '';
      let active = null;

      for (const cat in categorias) {
        const btn = document.createElement("div");
        btn.className = "categoria-btn";
        btn.textContent = cat;
        const box = document.createElement("div");
        box.className = "productos";

        categorias[cat].forEach(([nombre, precio]) => {
          const prod = document.createElement("div");
          prod.className = "producto";
          prod.textContent = `${nombre} üí≤${precio}`;
          prod.onclick = () => agregar(nombre, precio);
          box.appendChild(prod);
        });

        btn.onclick = () => {
          document.querySelectorAll(".productos").forEach(p => p.style.display = "none");
          if (active === box) { box.style.display = "none"; active = null; }
          else { box.style.display = "flex"; active = box; }
        };

        cont.appendChild(btn);
        cont.appendChild(box);
      }
    }

    function syncFirebase() {
      db.ref("likes").on("value", snapshot => {
        document.getElementById("contadorLikes").textContent = snapshot.val() || 0;
      });

      const userRef = db.ref("usuarios").push(true);
      userRef.onDisconnect().remove();
      db.ref("usuarios").on("value", snap => {
        const total = snap.numChildren();
        document.getElementById("contadorUsuarios").textContent = total;
      });
    }

    renderMenu();
    renderTotal();
    syncFirebase();
  </script>
</body>
</html>
